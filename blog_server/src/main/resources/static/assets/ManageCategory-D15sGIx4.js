import{r as p,A as j,i as q,b as z,d as t,w as a,a as s,p as A,B as F,o as f,e as i,H,k as w,g as _,u as D,a5 as J,a6 as L,t as S,M as G,J as g}from"./index-BvHamNfy.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"category-manage"},Q={class:"card-header"},W={class:"custom-tree-container"},X={class:"custom-tree-node"},Y={class:"node-label"},Z={class:"dialog-footer"},ee={__name:"ManageCategory",setup(te){const v=A("axios"),y=p([]),b=p(!1),M={children:"children",label:"name"};function x(){b.value=!0,v.get("/api/category/getTree").then(d=>{d.data.success&&(y.value=d.data.map.data||[]),b.value=!1})}j(()=>{x()});const c=p(!1),h=p(""),C=p(null),o=q({id:null,name:"",parentId:0,sort:0}),N={name:[{required:!0,message:"ËØ∑ËæìÂÖ•ÂàÜÁ±ªÂêçÁß∞",trigger:"blur"}]};function T(d,e){c.value=!0,o.id=null,o.name="",o.sort=0,h.value="Êñ∞Â¢ûÈ°∂Á∫ßÂàÜÁ±ª",o.parentId=0}function U(){C.value.validate(d=>{if(d){const e=o.id?"/api/category/update":"/api/category/add";v.post(e,o).then(n=>{n.data.success?(g.success(n.data.msg),c.value=!1,x()):g.error(n.data.msg)})}})}const E=(d,e,n,B)=>{let u=0;n==="inner"?u=e.data.id:u=e.data.parentId;const m=n==="inner"?e:e.parent,V=(m.level===0?y.value:m.data.children||[]).map((r,k)=>({id:r.id,parentId:u,name:r.name,sort:k+1}));v.post("/api/category/updateBatch",V).then(r=>{r.data.success?g.success("ÊéíÂ∫èÂ∑≤Êõ¥Êñ∞"):(g.error("ÊéíÂ∫è‰øùÂ≠òÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞ÈáçËØï"),x())})};return(d,e)=>{const n=s("el-button"),B=s("el-alert"),u=s("el-icon"),m=s("el-tree"),I=s("el-card"),V=s("el-input"),r=s("el-form-item"),k=s("el-input-number"),P=s("el-form"),R=s("el-dialog"),$=F("loading");return f(),z("div",O,[t(I,{shadow:"always"},{header:a(()=>[i("div",Q,[e[6]||(e[6]=i("span",null,"üè∑Ô∏è ÂàÜÁ±ª‰∏éÊ†áÁ≠æÁÆ°ÁêÜ",-1)),t(n,{type:"primary",icon:D(G),onClick:e[0]||(e[0]=l=>T("add_root"))},{default:a(()=>[...e[5]||(e[5]=[_("Êñ∞Âª∫È°∂Á∫ßÂàÜÁ±ª",-1)])]),_:1},8,["icon"])])]),default:a(()=>[t(B,{title:"ÊèêÁ§∫ÔºöÊîØÊåÅÊãñÊãΩËäÇÁÇπÊù•ÊîπÂèòÂ±ÇÁ∫ßÂíåÊéíÂ∫èÔºåÊìç‰ΩúÂêé‰ºöËá™Âä®‰øùÂ≠ò„ÄÇ",type:"info","show-icon":"",style:{"margin-bottom":"20px"},closable:!1}),i("div",W,[H((f(),w(m,{data:y.value,"node-key":"id","default-expand-all":"",draggable:"","allow-drop":d.allowDrop,onNodeDrop:E,"expand-on-click-node":!1,indent:30,props:M},{default:a(({data:l})=>[i("div",X,[i("span",Y,[l.children&&l.children.length>0?(f(),w(u,{key:0,class:"icon-folder"},{default:a(()=>[t(D(J))]),_:1})):(f(),w(u,{key:1,class:"icon-folder"},{default:a(()=>[t(D(L))]),_:1})),_(" "+S(l.name),1)])])]),_:1},8,["data","allow-drop"])),[[$,b.value]])])]),_:1}),t(R,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=l=>c.value=l),title:h.value,width:"400px"},{footer:a(()=>[i("span",Z,[t(n,{onClick:e[3]||(e[3]=l=>c.value=!1)},{default:a(()=>[...e[8]||(e[8]=[_("ÂèñÊ∂à",-1)])]),_:1}),t(n,{type:"primary",onClick:U},{default:a(()=>[...e[9]||(e[9]=[_("Á°ÆÂÆö",-1)])]),_:1})])]),default:a(()=>[t(P,{model:o,rules:N,ref_key:"formRef",ref:C,"label-width":"80px"},{default:a(()=>[t(r,{label:"ÂàÜÁ±ªÂêçÁß∞",prop:"name"},{default:a(()=>[t(V,{modelValue:o.name,"onUpdate:modelValue":e[1]||(e[1]=l=>o.name=l),placeholder:"ËØ∑ËæìÂÖ•ÂàÜÁ±ªÂêçÁß∞"},null,8,["modelValue"])]),_:1}),t(r,{label:"ÊéíÂ∫èÂÄº",prop:"sort"},{default:a(()=>[t(k,{modelValue:o.sort,"onUpdate:modelValue":e[2]||(e[2]=l=>o.sort=l),min:0},null,8,["modelValue"]),e[7]||(e[7]=i("span",{style:{"margin-left":"10px",color:"#999","font-size":"12px"}},"(Ë∂äÂ∞èË∂äÈù†Ââç)",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},le=K(ee,[["__scopeId","data-v-7d0909eb"]]);export{le as default};
