import{r as d,y as P,m as q,p as v,A as G,N as J,a,k as T,o as c,w as t,d as e,e as l,u as r,f as x,b as u,g as b,F as K,l as Q,O as W,t as g,P as X,D as Y,E as z}from"./index-CGgmL17t.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"notification-box"},ee={class:"header"},te={key:0,style:{"text-align":"center",color:"#999"}},oe={key:1,class:"msg-list"},ne={class:"msg-title"},se={class:"sender"},ae={class:"msg-content"},le={class:"msg-time"},ie=["innerHTML"],ce={__name:"Top",setup(re){const L=d(30),w=P(),h=q(),_=v("axios"),C=v("toLogin"),k=v("toHome"),M=v("toAdminMain"),y=d(""),i=d(!1),p=d(0),m=d([]);h.user.user!=null&&(y.value="hi "+h.user.user.username,i.value=!0);function E(){i.value&&_.get("/api/notification/unreadCount").then(n=>{n.data.success&&(p.value=n.data.map.count)})}function A(){i.value&&_.get("/api/notification/list").then(n=>{n.data.success&&(m.value=n.data.map.list)})}function B(){_.post("/api/notification/markAllRead").then(n=>{p.value=0,m.value.forEach(s=>s.isRead=!0)})}G(()=>{i.value&&E()}),J(()=>{});function R(){_({method:"post",url:"/api/logout"}).then(n=>{z.alert(n.data.msg,"结果"),h.user.user=null,i.value=!1,y.value="",k()}).catch(n=>{z.alert("系统错误！","结果")})}function H(){C?C():w.push("/login")}return(n,s)=>{const f=a("el-col"),N=a("el-icon"),S=a("el-badge"),V=a("el-button"),I=a("el-divider"),O=a("el-tag"),D=a("el-popover"),F=a("router-link"),U=a("el-space"),j=a("el-row");return c(),T(j,{class:"top",align:"middle"},{default:t(()=>[e(f,{span:3}),e(f,{span:12},{default:t(()=>[l("a",{onClick:s[0]||(s[0]=(...o)=>r(k)&&r(k)(...o))},"CrazyStone个人博客小站")]),_:1}),e(f,{span:6},{default:t(()=>[e(U,{size:L.value},{default:t(()=>[i.value?(c(),T(D,{key:0,placement:"bottom",width:300,trigger:"click",onShow:A},{reference:t(()=>[e(S,{value:p.value,max:99,hidden:p.value===0,class:"item"},{default:t(()=>[e(N,{class:"searchIcon",size:20,style:{cursor:"pointer","margin-top":"5px"}},{default:t(()=>[e(r(X))]),_:1})]),_:1},8,["value","hidden"])]),default:t(()=>[l("div",$,[l("div",ee,[s[3]||(s[3]=l("span",null,"消息通知",-1)),e(V,{link:"",type:"primary",size:"small",onClick:B},{default:t(()=>[...s[2]||(s[2]=[b("全部已读",-1)])]),_:1})]),e(I,{style:{margin:"10px 0"}}),m.value.length===0?(c(),u("div",te,"暂无消息")):(c(),u("ul",oe,[(c(!0),u(K,null,Q(m.value,o=>(c(),u("li",{key:o.id,class:W({unread:!o.isRead})},[l("div",ne,[e(O,{size:"small",type:o.type==="COMMENT"?"success":"warning"},{default:t(()=>[b(g(o.type==="COMMENT"?"评论":"回复"),1)]),_:2},1032,["type"]),l("span",se,g(o.senderName),1)]),l("div",ae,g(o.content),1),l("div",le,g(o.created),1)],2))),128))]))])]),_:1})):x("",!0),i.value?x("",!0):(c(),u("a",{key:1,onClick:H},"登录")),l("a",{onClick:s[1]||(s[1]=(...o)=>r(M)&&r(M)(...o))},"后台管理"),i.value?(c(),u("a",{key:2,onClick:R},"退出")):x("",!0),l("span",{innerHTML:y.value},null,8,ie),e(F,{title:"查询",to:{path:"/search"},style:{"text-decoration":"none"}},{default:t(()=>[e(N,null,{default:t(()=>[e(r(Y),{class:"searchIcon"})]),_:1})]),_:1})]),_:1},8,["size"])]),_:1}),e(f,{span:3})]),_:1})}}},_e=Z(ce,[["__scopeId","data-v-8472ff28"]]);export{_e as T};
